# Penal Code Article Summarizer and Keyword Generator

This repository contains code for summarizing legal articles from the Penal Code and generating keywords using the `unsloth` language model. The results are saved in a CSV file, making it easy to review the generated summaries and keywords.

## Features

- **Automatic Summarization**: The code generates concise summaries of legal articles.
- **Keyword Generation**: The model extracts relevant keywords for classification of each article.
- **CSV Export**: The results (summaries and keywords) are saved in a CSV file for easy access.
- **Integration with Google Drive**: Articles are loaded directly from Google Drive, and the CSV file is saved back to Drive.

## Requirements

The following Python libraries are required:
- `torch`: For model execution
- `triton`: A dependency for `torch`
- `unsloth`: The FastLanguageModel used for text generation
- `transformers`: For managing and tokenizing text
- `google.colab`: To access and mount Google Drive
- `csv`: For saving results in a CSV format

## Installation

You can install the required dependencies with the following commands:

```bash
!pip install --upgrade --force-reinstall --no-cache-dir torch==2.1.0 triton --index-url https://download.pytorch.org/whl/cu121
!pip install "unsloth[cu121-ampere] @ git+https://github.com/unslothai/unsloth.git"
```

And then put your HuggingFace token to the following line of the JupyterNotebbok:
```python
hf_token = "XXX"
```

## Usage

### Mount Google Drive:
Ensure that you have your legal articles stored in `.txt` format in a Google Drive directory. This code assumes that the articles are stored in `/content/drive/MyDrive/ColabNotebooks/CodePenal/`. Mount your Google Drive with:

```python
from google.colab import drive
drive.mount('/content/drive')
```

### Load Articles:
The function load_articles() reads all the .txt files from the specified directory, where each file corresponds to a legal article.

```python
articles, titles = load_articles('/content/drive/MyDrive/ColabNotebooks/CodePenal/')
```

### Summarize Articles and Generate Keywords:
Use the summarize_article() function to generate a concise summary and five relevant keywords for each article.

```python
summary, keywords = summarize_article(article_text, article_title)
```

### Save Results to CSV:
The save_data_to_csv() function stores the summaries and keywords in a CSV file for further analysis. The CSV includes the index, title, summary, and keywords for each article.

```python
save_data_to_csv(output_csv_file, data_to_save)
```

### Example:
Here is a basic example that processes the first 5 articles:

 ```python
for i, (file, text) in enumerate(articles.items()):
    if i >= 5:
        break
    summary, keywords = summarize_article(text, titles[file])
    data_to_save.append((titles[file], summary, keywords))

```

### Output:
The results are saved in a CSV file in Google Drive:
```python
output_csv_file = "/content/drive/MyDrive/ColabNotebooks/CodePenal/summaries_keywords.csv"
save_data_to_csv(output_csv_file, data_to_save)
```

## File Structure
```bash
├── PenalCodeSummarizer.ipynb    # Jupyter Notebook containing the code
├── README.md                    # Documentation file (this file)
└── summaries_keywords.csv        # CSV output with summaries and keywords (generated by the code)
```
